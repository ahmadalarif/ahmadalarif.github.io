<!-- Content Wrapper. Contains page content -->
<div class="pcoded-main-container">
<div class="pcoded-content">
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <div class="content-header">
      <div class="container-fluid">
        <div class="row mb-2">
          <div class="col-12">
            <h1 class="m-0 text-dark">جدول الحضور (Ahmad Arif)</h1>
          </div><!-- /.col -->
          
        </div><!-- /.row -->
      </div><!-- /.container-fluid -->
    </div>
    <!-- /.content-header -->

    <!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        


<!--Data table-->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
            <div class="card-title">
                <b>إجمالي مدة العمل: 2د </b> |
                <b>إجمالي ساعات العمل الإضافي: 0h</b>
            </div>
                <div class="card-tools print-not">
                    
                    <a href="/attendance/add/"
                        class="btn btn-info">
                        <i class="fas fa-plus"></i>
                        إضافة سجل
                    </a>
                    <a href="/attendance/timesheet/requests/"
                        class="btn btn-primary"><i class="fas fa-tasks"></i>
                        طلبات التعديل
                    </a>
                    
                    <button onclick="print(event)" class="btn btn-secondary" data-toggle="tooltip"
                        title="طباعة"><i class="fas fa-print"></i>
                    </button>
                    <button id="csv" class="btn btn-success" data-toggle="tooltip"
                        title="تحميل ملف إكسل"><i
                            class="fa-solid fa-table"></i>
                    </button>
                </div>
            </div>
            <!-- /.card-header -->
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <h5 class="print-only">
                            <strong>جدول الحضور: Ahmad Arif </strong>
                        </h5>
                        <form class="print-not" method="GET" id="daterangeform">
                            الفترة:
                            <div id="daterangepicker" class="form-control" style="display: inline; cursor: pointer;">
                                <i class="fas fa-calendar"></i>
                                <span class="mx-2">1 يوليو 2023 - 16 يوليو 2023</span>
                                <i class="fa fa-caret-down"></i>
                            </div>
                            <input type="text" name="start" id="start" value="1 يوليو 2023" hidden>
                            <input type="text" name="end" id="end" value="16 يوليو 2023" hidden>
                        </form>
                    </div>
                    <div class="col-md-4">
                        <h5 class="text-center">
                            <strong>1 يوليو 2023 - 16 يوليو 2023</strong>
                        </h5>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-sm-12">
                        <table id="timesheet" class="table table-bordered">
                            <thead>
                                <tr role="row">
                                    <th>
                                        اليوم
                                    </th>
                                    <th>
                                        حضور
                                    </th>
                                    <th>
                                        انصراف
                                    </th>
                                    <th>
                                        مدة العمل
                                    </th>
                                    <th>
                                        ساعات عمل إضافي
                                    </th>
                                    <th class="print-not">
                                        إجراء
                                    </th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- timesheet_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-16">
                                        أحد, 16 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-15">
                                        سبت, 15 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-14">
                                        جمعة, 14 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                

                                <tr role="row">                                    
                                    <!-- Day cell -->
                                    <td data="2023-07-13">
                                        خميس, 13 يوليو
                                    </td>
                                    
                                    <!-- Entry cell -->
                                    <td data-toggle="tooltip"
                                        title="" data="09:48:00">

                                        <span title="2023-07-13 9:48 ص">
                                            9:48 ص
                                        </span>
                                    </td>
                                    

                                    <!-- Exit cell -->
                                    <td data-toggle="tooltip" title=""
                                        data="09:50:00">
                                        <span title="الخميس, يوليو 13, 2023 9:50:00 ص">
                                            9:50 ص
                                        </span>
                                        
                                        
                                    </td>

                                    <!-- Worked hours cell -->
                                    <td data="0:02:00">
                                        2د 
                                    </td>

                                    <!-- Overtime cell -->
                                    <td data="---">
                                        0h
                                    </td>

                                    <!-- Action buttons cell -->
                                    <td class="print-not">
                                        <!-- view record -->
                                        <a class="btn btn-primary btn-sm"
                                            href="/attendance/record/18835/" title="استعراض">
                                            <i class="fas fa-eye"></i>
                                        </a>

                                        
                                        <a class="btn btn-info btn-sm"
                                            href="/attendance/edit/18835/"
                                            title="تعديل">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        
                                    </td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-12">
                                        أربعاء, 12 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-11">
                                        ثلاثاء, 11 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-10">
                                        إثنين, 10 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-09">
                                        أحد, 9 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-08">
                                        سبت, 8 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-07">
                                        جمعة, 7 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-06">
                                        خميس, 6 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-05">
                                        أربعاء, 5 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-04">
                                        ثلاثاء, 4 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-03">
                                        إثنين, 3 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-02">
                                        أحد, 2 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- attendance_records -->
                                
                                <tr role="row">
                                    <td data="2023-07-01">
                                        سبت, 1 يوليو
                                    </td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    
                                    <td>---</td>
                                    <td>---</td>
                                    <td class="print-not"></td>
                                </tr>
                                
                                <!-- /.attendance_records -->
                                
                                <!-- /.timesheet_rows -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <!-- /.card-body -->
        </div>
    </div>
    <!-- /.col -->
</div>
<!-- /.row -->



      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  

</div>
</div>
</div>
<!-- ./wrapper -->

    

    
    
    <!-- jQuery -->
    <script src="/static/js/jquery/jquery.min.js"></script>
    <!-- Bootstrap 4 -->
    <script src="/static/js/plugins/bootstrap/bootstrap.bundle.min.js">
    </script>
    <!-- overlayScrollbars -->
    <script src="/static/js/plugins/overlayScrollbars/jquery.overlayScrollbars.min.js">
    </script>
    <!-- AdminLTE App -->
    <script src="/static/js/plugins/admin-lte/adminlte.min.js"></script>
    <!-- Sweet Alerts -->
    <script src="/static/js/plugins/sweetalert/sweetalert2.all.min.js"></script>
    <script src="/static/js/plugins/sweetalert/sweetalert.js"></script>
    <script>
        // Prevent any form from multiple submissions after the first valid one.
        const forms = document.querySelectorAll('form');
        forms.forEach((form) => {
            form.onsubmit = function (e) {
                if (form.reportValidity())
                    // if form is valid, prevent future submissions by returning false.
                    form.onsubmit = (_) => false;
                return true;
            }
        });
    </script>
    <script>
        $(function () {
            // Remove message alert if close button clicked
            $('body').on('click', '[data-dismiss=toast]',function () {
                $(this).parent().parent().fadeOut();
            });

            /** add active class and stay opened when selected */
            var url = window.location.href.split(/[?#]/)[0];

            // for sidebar menu entirely but not cover treeview
            $('ul.nav-sidebar a').filter(function () {
                return this.href == url;
            }).addClass('active');

            // for treeview
            $('ul.nav-treeview a').filter(function () {
                return this.href == url;
            }).parentsUntil(".nav-sidebar > .nav-treeview").addClass('menu-open').prev('a').addClass(
                'active');

            // Send feedback event handler
            $('#submit-feedback').click(function(){
                var feedback = $('#feedback-text').val();
                feedback = feedback.trim()
                $('#feedback-text').val(feedback);
                if (!$('#feedback-text')[0].reportValidity()) return;
                
                var data = {
                "feedback": feedback,
                "csrfmiddlewaretoken": "Z9ovRdKeaTaucq1WsfXL5nGxiSuG9q420mS7H1ol93CeYa6K0FaprPmiwWw54Thv"};

                $('#feedback-modal').modal('toggle');

                $.ajax({
                type: "POST",
                data: data,
                dataType: 'json',
                url: "/feedback/",
                success: function(response){
                    if (response.status == "success"){
                        successAlert(response.message);
                        $('#feedback-text').val('');
                    }
                    else {
                        errorAlert(response.message);
                    }
                },
                error: errorAlert
                });
            });

            // Initiate tooltip if data-toggle="tooltip" and title attributes are set on any html element
            $('[data-toggle="tooltip"], .tooltip-wrapper, .btn-sm').tooltip();
            

        });
    </script>
    
<!--DataTables-->
<script src="/static/js/plugins/dataTables/jquery.dataTables.min.js"></script>
<script src="/static/js/plugins/dataTables/dataTables.bootstrap4.min.js"></script>

<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<script>
    $(function () {
        $('#timesheet').DataTable({
            "paging": false,
            "lengthChange": false,
            "searching": false,
            "ordering": false,
            "info": false,
            "autoWidth": true,
            "responsive": false,
            "dom": "<'row'<'col-md-6'><'col-md-6'l>>" +
                "<'row'<'col-md-12't>><'row'<'col-md-6'i><'col-md-6'p>>",
            "language": {
                "emptyTable": "لا توجد بيانات لعرضها",
                },
        });

        $('#daterangepicker').daterangepicker({
            "showDropdowns": true,
            "minYear": 2022,
            "maxSpan": {
                "days": 60
            },
            ranges: {
                "اليوم": [moment(), moment()],
                "أمس": [moment().subtract(1, 'days'), moment().subtract(1, 'days')],
                "آخر 7 أيام": [moment().subtract(6, 'days'), moment()],
                "آخر 30 يوم": [moment().subtract(29, 'days'), moment()],
                "هذا الشهر": [moment().startOf('month'), moment().endOf('month')],
                "الشهر الماضي": [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')]
            },
            "locale": {
                "format": "YYYY-MM-DD",
                "separator": " - ",
                "applyLabel": "تنفيذ",
                "cancelLabel": "إلغاء",
                "fromLabel": "من",
                "toLabel": "إلى",
                "customRangeLabel": "تخصيص",
                "weekLabel": "اس",
                "daysOfWeek": [
                    "أح",
                    "اث",
                    "ثل",
                    "أر",
                    "خم",
                    "جم",
                    "سب"
                ],
                "monthNames": [
                    "يناير",
                    "فبراير",
                    "مارس",
                    "أبريل",
                    "مايو",
                    "يونيو",
                    "يوليو",
                    "أغسطس",
                    "سبتمبر",
                    "أكتوبر",
                    "نوفمبر",
                    "ديسمبر"
                ],
                "firstDay": 0
            },
            "showCustomRangeLabel": false,
            "alwaysShowCalendars": true,
            "startDate": "2023-07-01",
            "endDate": "2023-07-16",
            "maxDate": "2023-07-16",
            "opens": "center",
            "drops": "auto"
        }, function(start, end, label) {
            $('#start').val(start.format('YYYY-MM-DD'))
            $('#end').val(end.format('YYYY-MM-DD'))
            $('#daterangeform').submit()
        });

    });

    $('#csv').click(function () {
        var api = $('#timesheet').dataTable().api();
        var headers = api.columns().header();
        var headersList = []
        for (i=0; i<headers.length-1; i++){
            headersList.push(headers[i].innerText);
        }

        var rowsList = [];
        var rows = api.rows().nodes();
        for (i=0; i<rows.length; i++){
            var row = []
            var cells = rows[i].cells;
           for (j=0; j<cells.length-1; j++){
            cellData = cells[j].getAttribute('data');
            if (cellData) cellData=cellData.split('.')[0];
            row.push(cellData);
           }
            rowsList.push(row);
        }

        var filename = document.title;
        downloadCSVFromLists(filename + ".csv", rowsList, headersList);
    });

    downloadCSVFromLists = (filename, rows, headersList) => {
        // convert lists to CSV

        let csv = rows.map(row => row.join(','))
        csv.unshift(headersList.join(','))
        csv = csv.join('\r\n')

        // Create link and download
        var link = document.createElement('a');
        link.setAttribute('href', 'data:text/csv;charset=utf-8,%EF%BB%BF' + encodeURIComponent(csv));
        link.setAttribute('download', filename);
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    };

</script>